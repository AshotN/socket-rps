// Generated by CoffeeScript 1.7.1
(function() {
  $(document).ready(function() {
    var arrow, socket;
    socket = io("http://hego555.no-ip.org:5555");
    arrow = false;
    socket.on("redirect", function(data) {
      console.log("redirect to " + data.url);
      return window.location = data.url;
    });
    $("#makesettings").click(function() {
      $(".eachsetting").slideToggle(600);
      if (arrow) {
        $(".arrow").attr("src", "images/down.png");
        return arrow = false;
      } else {
        $(".arrow").attr("src", "images/up.png");
        return arrow = true;
      }
    });
    $("#join").click(function() {
      var roomnum;
      roomnum = prompt("Whats The Room Name!");
      return socket.emit("joinroom", {
        username: user,
        id: roomnum,
        password: "ashot",
        token: token
      });
    });
    $("#make").click(function() {
      return socket.emit("makeroom", {
        password: $(".password").val()
      });
    });
    $(".headermessage").click(function() {
      if ($(this).text() === "Login") {
        $("#login").fadeIn("fast");
        return $("#backgroundDarkener").show();
      }
    });
    $("#backgroundDarkener").click(function() {
      $(this).fadeOut("fast");
      return $("#login").fadeOut("fast");
    });
    $("#loginbutton").click(function(event) {
      var hash, hashSHA512, password, username;
      console.log("A");
      username = $("#username").val();
      password = $("#password").val();
      if ((username === "" || (username == null)) || (password === "" || (password == null))) {
        return console.log("No Credentials");
      } else {
        console.log("D");
        console.log("" + username + ":" + password);
        hashSHA512 = CryptoJS.SHA512(password).toString();
        hash = CryptoJS.MD5(hashSHA512).toString();
        return $.post("handlelogin", {
          user: username,
          pass: hash
        }, function(data) {
          if (data.length > 0) {
            console.log("B");
            $("#loginoutput").html(data);
            $("#loginoutput").show("fast");
          } else {
            console.log("C");
            $("#loginoutput").html("Error");
            $("#loginoutput").show("fast");
          }
        }).done(function(data) {
          console.log("success");
          if (data.indexOf("Welcome") >= 0) {
            $("#backgroundDarkener").fadeOut("fast");
            $("#login").fadeOut("fast");
            $(".headermessage").html("Welcome " + username);
          }
        });
      }
    });
  });

}).call(this);
